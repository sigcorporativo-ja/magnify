!function(e){var t={};function o(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=3)}([function(e,t){e.exports='<div class="m-magnify-container">\r\n    <div id="m-magnify-titulo" class="title">LUPA</div>\r\n    <div class="m-magnify-panel">\r\n        <div class="m-magnify-effect-buttoms">\r\n            <button id="m-magnify-magnifying" class="g-cartografia-zoom-extension big-buttom" title="Activa lupa"></button>\r\n        </div>\r\n        <div class="m-magnify-zoom-offset">\r\n            <p>Nivel de zoom: </p>\r\n            <input type="number" min="1" max="{{zoomMax}}" step="0.5" class="m-magnify-zoom-offset-input" id="input-zoom-offset"></input>\r\n        </div>\r\n    </div>\r\n</div>'},function(e){e.exports=JSON.parse('{"url":{"name":"magnify","separator":"*"},"constructor":"M.plugin.Magnify","parameters":[{"type":"object","properties":[{"type":"simple","name":"position","position":0,"possibleValues":["TL","TR","BL","BR"]},{"type":"simple","name":"layers","position":1},{"type":"simple","name":"zoomMax","position":2},{"type":"simple","name":"zoom","position":3}]}],"files":{"ol":{"scripts":["magnify.ol.min.js"],"styles":["magnify.ol.min.css"]}},"metadata":{"name":"magnify","description":"Efecto lupa-zoom sobre capa","text":"Plugin que permite realizar un efecto de zoom o de lupa sobre una o varias capas","version":"1.0.0","date":"Junio, 2020","author":"","org":"Consejería de Hacienda, Industria y Energía. Junta de Andalucía.","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg","centralized":true}}')},function(e,t,o){},function(e,t,o){"use strict";o.r(t);o(2);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=function(e){function t(e){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i,l,s=document.createElement("div");s.className="ol-magnify",i=this,(o=!(l=r(t).call(this,{positioning:e.positioning||"center-center",element:s,stopEvent:!1}))||"object"!==n(l)&&"function"!=typeof l?a(i):l)._elt=s;var u=e.layers.map((function(e){return e.getImpl().getOL3Layer()})).filter((function(e){return null!=e}));return o.mgmap_=new ol.Map({controls:new ol.Collection,interactions:new ol.Collection,target:o._elt,view:new ol.View({projection:e.projection}),layers:u}),o.mgview_=o.mgmap_.getView(),o.set("zoomOffset",e.zoom+1),o.set("active",!0),o.on("propertychange",o.setView_.bind(a(o))),o}var o,s,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,ol.Overlay),o=t,(s=[{key:"setMap",value:function(e){this.getMap()&&this.getMap().getViewport().removeEventListener("mousemove",this.onMouseMove_),this._listener&&ol.Observable.unByKey(this._listener),this._listener=null,ol.Overlay.prototype.setMap.call(this,e),e.getViewport().addEventListener("mousemove",this.onMouseMove_.bind(this)),this._listener=e.getView().on("propertychange",this.setView_.bind(this)),this.setView_()}},{key:"getMagMap",value:function(){return this.mgmap_}},{key:"getActive",value:function(){return this.get("active")}},{key:"setActive",value:function(e){return this.set("active",e)}},{key:"onMouseMove_",value:function(e){if(this.get("active")){var t=this.getMap().getEventCoordinate(e);this.setPosition(t),this.mgview_.setCenter(t),this.mgmap_.updateSize()}else this.setPosition()}},{key:"setView_",value:function(e){if(this.get("active")){if(!e)return this.setView_({key:"rotation"}),void this.setView_({key:"resolution"});switch(e.key){case"rotation":this.mgview_.setRotation(this.getMap().getView().getRotation());break;case"zoomOffset":case"resolution":var t=Math.max(0,this.getMap().getView().getZoom()+Number(this.get("zoomOffset")));this.mgview_.setZoom(t)}}else this.setPosition()}},{key:"setOptionZoom",value:function(e){this.set("zoomOffset",e+1)}}])&&i(o.prototype,s),u&&i(o,u),t}();function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e,t,o){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,o){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(o):i.value}})(e,t,o||e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,m(t).apply(this,arguments))}var o,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,M.impl.Control),o=t,(n=[{key:"addTo",value:function(e,o){this.map=e,this.olMap=e.getMapImpl(),p(m(t.prototype),"addTo",this).call(this,e,o)}},{key:"effectSelected",value:function(e,t){this.zoomInteraction_=new s({projection:this.map.getImpl().getProjection().code,zoom:t,layers:e}),this.olMap.addOverlay(this.zoomInteraction_),this.zoomInteraction_.setActive(!0)}},{key:"setOptionZoom",value:function(e){this.zoomInteraction_.setOptionZoom(e)}},{key:"removeEffects",value:function(){null!=this.zoomInteraction_&&this.zoomInteraction_.setActive(!1)}}])&&c(o.prototype,n),i&&c(o,i),t}(),b=o(0),d=o.n(b);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var z=function(e){function t(e){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),M.utils.isUndefined(g)&&M.exception("La implementación usada no puede crear controles MagnifyControl");var n=new g;return(o=w(this,_(t).call(this,n,"Magnify"))).pluginOnLeft=e.pluginOnLeft,o.arrayListNames=e.layers,o.zoom=e.zoom,o.zoomMax=e.zoomMax,o}var o,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(t,M.Control),o=t,(n=[{key:"createView",value:function(e){var t=this;return this.map=e,new Promise((function(o,n){t.pluginOnLeft&&document.querySelector(".m-panel.m-plugin-magnify").querySelector(".m-panel-btn.g-cartografia-zoom-extension").addEventListener("click",(function(e){var o=document.querySelector(".m-panel.m-plugin-magnify.opened");null!==o&&(o=o.querySelector(".m-panel-btn.g-cartografia-flecha-izquierda")),o&&t.pluginOnLeft&&o.classList.add("opened-left")}));var i={vars:{zoomMax:t.zoomMax}},r=M.template.compileSync(d.a,i);r.querySelector("#input-zoom-offset").value=t.zoom,r.querySelector("#input-zoom-offset").addEventListener("change",(function(e){t.zoom=Number(e.target.value),t.getImpl().setOptionZoom(t.zoom)})),r.querySelector("#m-magnify-magnifying").addEventListener("click",(function(o){if(0==document.getElementsByClassName("buttom-pressed").length){r.querySelector("#m-magnify-magnifying").classList.add("buttom-pressed");var n=e.getLayers().filter((function(e){return e.name})),i=n.filter((function(e){return t.arrayListNames.includes(e.name)})),a=t.map.getBaseLayers();0==a?t.getImpl().effectSelected(n,t.zoom):0===i.length?t.getImpl().effectSelected(a,t.zoom):t.getImpl().effectSelected(i,t.zoom)}else r.querySelector("#m-magnify-magnifying").classList.remove("buttom-pressed"),t.removeEffects()})),o(r)}))}},{key:"removeEffects",value:function(){this.getImpl().removeEffects()}},{key:"equals",value:function(e){return e instanceof t}}])&&v(o.prototype,n),i&&v(o,i),t}(),S=o(1);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var L=function(e){function t(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=k(this,x(t).call(this))).map_=null,e.controls_=[],e.collapsible=!0,e.className="m-plugin-magnify",e.position=o.position||"TR",""==o.layers||null==o.layers?e.layers="":e.layers=o.layers.split(","),e.zoomMax=o.zoomMax||10,e.zoom=o.zoom||1,e.metadata_=S.metadata,e}var o,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,M.Plugin),o=t,(n=[{key:"addTo",value:function(e){var t=this,o={pluginOnLeft:!!["TL","BL"].includes(this.position),layers:this.layers,zoom:this.zoom,zoomMax:this.zoomMax};this.control_=new z(o),this.controls_.push(this.control_),this.map_=e,this.panel_=new M.ui.Panel("panelMagnify",{collapsible:this.collapsible,position:M.ui.position[this.position],className:this.className,collapsedButtonClass:"g-cartografia-zoom-extension",tooltip:"Lupa"}),this.panel_.addControls(this.controls_),this.panel_.on(M.evt.SHOW,(function(o){0===e.getWFS().length&&0===e.getKML().length&&0===e.getGeoJSON()&&(t.panel_.collapse(),M.dialog.info("No existen capas disponibles para aplicar el efecto transparencia"))})),e.addPanels(this.panel_)}},{key:"destroy",value:function(){this.control_.removeEffects(),this.map_.removeControls([this.control_]);var e=[null,null,null];this.control_=e[0],this.panel_=e[1],this.map_=e[2]}},{key:"getControls",value:function(){var e=[];return e.push(this.control_),e}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"name",get:function(){return"magnify"}}])&&P(o.prototype,n),i&&P(o,i),t}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.plugin.Magnify=L,window.M.control.MagnifyControl=z,window.M.impl.control.ZoomInteraction=s,window.M.impl.control.MagnifyControl=g}]);
//# sourceMappingURL=magnify.ol.min.js.map